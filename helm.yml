---
- name: Deploy Grafana from Helm chart
  hosts: all
  become: yes
  gather_facts: no
  vars:
    api_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          38623934376234313331316462316266396232323834646634353866363532643261323362383965
          3161376265623666393436653937653062353038636436330a333139386539343835383431663537
          34363630613633323137353834366436616532666562363861623666636535303130666532653936
          3536353663613735660a656534303730306539393130356536643230663935633336393165353334
          64643362646230396439383833373036366237666662666361313762366336326438363932396138
          31336362363463313738623230383365363961326363396130396330626534666337636461306463
          323834353736623339343837373538323366
  # From url
  - name: Deploy Grafana chart on 5.6.0 from url to helm-test namespace
    community.kubernetes.helm:
      name: test
      chart_ref: "https://github.com/grafana/helm-charts/releases/download/grafana-5.6.0/grafana-5.6.0.tgz"
      release_namespace: helm-test
