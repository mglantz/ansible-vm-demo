---
- name: Deploy Grafana from Helm chart
  hosts: all
  become: yes
  gather_facts: no
  vars:
    api_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          38623934376234313331316462316266396232323834646634353866363532643261323362383965
          3161376265623666393436653937653062353038636436330a333139386539343835383431663537
          34363630613633323137353834366436616532666562363861623666636535303130666532653936
          3536353663613735660a656534303730306539393130356536643230663935633336393165353334
          64643362646230396439383833373036366237666662666361313762366336326438363932396138
          31336362363463313738623230383365363961326363396130396330626534666337636461306463
          323834353736623339343837373538323366
    host: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39383430333836366531306138323835313762323132623166356330376135336266356165643830
          3161373037336164353262313664653762306162306333640a313366343032306466373934613630
          35383037393336343633613932316139356162366139316430323666396432643031363465323665
          3433343864613334370a323236383765646136373634663161343136613936303734366562323562
          66346363663239613239396133623063356437306163663331633133383062383666376233326236
          65346363353761613238633932376561633563343765313566303339313337333838663262356438
          396231613665343032636132386562373434
  - name: Deploy Grafana chart on 5.6.0 from url to helm-test namespace
    community.kubernetes.helm:
      name: test
      chart_ref: "https://github.com/grafana/helm-charts/releases/download/grafana-5.6.0/grafana-5.6.0.tgz"
      release_namespace: helm-test
